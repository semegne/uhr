"use strict";(self.webpackChunkbisema_basic=self.webpackChunkbisema_basic||[]).push([[925],{6925:(te,T,c)=>{c.r(T),c.d(T,{AdminModule:()=>f});var l=c(6895),Z=c(6491),s=c(433),e=c(1571),q=c(5136);class d extends q.b{constructor(r){super(r)}sendEmail(r){return this._networkService.post("api/order/mail",r)}getAdminCartItems(r,t){return this._networkService.get(`api/get/admin/cart/${r}/${t}`)}getProjectsByDealerID(r){return this._networkService.get(`api/project/${r}`)}checkIfExistsWithName(r,t){return this._networkService.post("api/project/checkIfExistsWithName",{dealers_id:r,projectName:t})}createProject(r){return this._networkService.post("api/project/create",r)}getUsers(r){return this._networkService.get(`api/dealer/users/${r}`)}addUser(r){return this._networkService.post("api/dealer/users/create",r)}updateUser(r){return this._networkService.post("api/user/updateUser",r)}deleteUser(r){return this._networkService.delete(`api/user/deleteUser/${r}`)}}d.\u0275fac=function(r){return new(r||d)(e.LFG(e.zs3))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac});var k=c(7185),m=c(7103),C=c(1815),_=c(2687),A=c(2216);class b{constructor(r,t){this.adminService=r,this.router=t,this.faUserCircle=_.m08}logout(){this.adminService._storageService.removeItem("user"),this.router.navigateByUrl("/login")}}b.\u0275fac=function(r){return new(r||b)(e.Y36(d),e.Y36(Z.F0))},b.\u0275cmp=e.Xpm({type:b,selectors:[["app-admin-header"]],decls:14,vars:1,consts:[[1,"navbar","navbar-dark","bg-purple","navbar-expand-sm"],[1,"container-fluid","align-items-center","px-0"],[1,"d-flex","align-items-center","me-5"],["href","http://www.bisema.com","target","_blank",1,"navbar-brand"],["src","../assets/img/bisema_logo.jpg","alt","logo","height","35"],[1,"navbar-text","text-white","h5","me-5","pe-5","d-md-block","d-none"],[1,"me-2"],["ngbDropdown","","display","dynamic","placement","bottom-end",1,"nav-item","ms-3"],["tabindex","0","ngbDropdownToggle","","id","navbarDropdown3","role","button",1,"nav-link","text-white","userAnchor"],[3,"icon"],["ngbDropdownMenu","","aria-labelledby","navbarDropdown3",1,"dropdown-menu"],["ngbDropdownItem","","href","javascript:;",3,"click"]],template:function(r,t){1&r&&(e.TgZ(0,"nav",0)(1,"div",1)(2,"div",2)(3,"a",3),e._UZ(4,"img",4),e.qZA()(),e.TgZ(5,"div",5),e._uU(6," BiSemA Corporation Cloud Specification Services "),e.qZA(),e.TgZ(7,"div",6)(8,"div",7)(9,"a",8),e._UZ(10,"fa-icon",9),e.qZA(),e.TgZ(11,"div",10)(12,"a",11),e.NdJ("click",function(){return t.logout()}),e._uU(13,"Log Out"),e.qZA()()()()()()),2&r&&(e.xp6(10),e.Q6J("icon",t.faUserCircle))},dependencies:[m.jt,m.iD,m.Vi,m.TH,m.M2,A.BN],styles:[".userAnchor[_ngcontent-%COMP%]{font-size:20px}"]});class v{}v.\u0275fac=function(r){return new(r||v)},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-admin-footer"]],decls:19,vars:0,consts:[[1,"row","bg-purple","pt-3"],[1,"col-12"],[1,"d-flex","justify-content-center"],[1,"list-inline","list-unstyled","m-0"],[1,"list-inline-item"],["href","https://www.facebook.com","target","https://www.facebook.com/bisemacorp",1,"text-white"],[1,"fa-brands","fa-facebook","fa-2x","me-2"],["href","https://www.linkedin.com ","target","https://www.linkedin.com/bisema-corporation",1,"text-white"],[1,"fa-brands","fa-linkedin","fa-2x","me-2"],["href","https://www.twitter.com ","target","https://www.twitter.com/bisemacorp",1,"text-white"],[1,"fa-brands","fa-twitter","fa-2x"],[1,"text-center","mt-3"],[1,"text-white"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"ul",3)(4,"li",4)(5,"a",5),e._UZ(6,"i",6),e.qZA()(),e.TgZ(7,"li",4)(8,"a",7),e._UZ(9,"i",8),e.qZA()(),e.TgZ(10,"li",4)(11,"a",9),e._UZ(12,"i",10),e.qZA()()()(),e.TgZ(13,"div",11)(14,"p",12),e._uU(15,"Copyright "),e.TgZ(16,"span"),e._uU(17,"\xa9"),e.qZA(),e._uU(18," 2023 BiSemA Corporation."),e.qZA()()()())}});const y=["dataToExport"],N=["content"],P=function(o){return{"bg-red":o}};function S(o,r){if(1&o&&(e.TgZ(0,"tr",31)(1,"td"),e._uU(2),e.qZA(),e.TgZ(3,"td"),e._uU(4),e.qZA(),e.TgZ(5,"td"),e._uU(6),e.qZA(),e.TgZ(7,"td",24),e._uU(8),e.qZA(),e.TgZ(9,"td"),e._uU(10),e.qZA(),e.TgZ(11,"td"),e._uU(12),e.ALo(13,"currency"),e.qZA(),e.TgZ(14,"td"),e._uU(15),e.qZA(),e.TgZ(16,"td"),e._uU(17),e.ALo(18,"currency"),e.qZA()()),2&o){const t=r.$implicit,n=r.index;e.Q6J("ngClass",e.VKq(13,P,""==t.backgroundColor)),e.xp6(2),e.Oqu(n+1),e.xp6(2),e.Oqu(t.manufacturingCompanyThreeLettersCode),e.xp6(2),e.Oqu(t.catalogThreeLettersCode),e.xp6(2),e.Oqu(t.fullSpecificationCode),e.xp6(2),e.Oqu(t.displayName),e.xp6(2),e.Oqu(e.lcZ(13,9,t.unitPrice)),e.xp6(3),e.Oqu(t.quantity),e.xp6(2),e.Oqu(e.lcZ(18,11,t.quantity*t.unitPrice))}}function M(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"h5",34),e._uU(3,"BiSemA Corporation Cloud Specification Services"),e.qZA()(),e.TgZ(4,"h5",35),e._uU(5,"Your Order Admin Dealer has been sent."),e.qZA(),e.TgZ(6,"div",36)(7,"button",37),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.dismiss("Cross click"))}),e._uU(8,"Close"),e.qZA()()()}}const J=function(){return{label1:"Name"}},I=function(){return{label1:"Email"}},D=function(){return{label1:"Phone"}},F=function(){return{label1:"Address"}};class U{constructor(r,t,n,i){this.fb=r,this.adminService=t,this.toastr=n,this.modalService=i,this.fromPerson=this.fb.group({name:["",[s.kI.required]],email:["",[s.kI.required,s.kI.email]],phone:["",[s.kI.required]],address:["",[s.kI.required]]}),this.cart=[],this.grandTotal=null,this.calGrandTotal=null,this.discountControl=new s.NI(""),this.discountControl.valueChanges.subscribe(a=>{this.calculateDiscount()})}getCart(){let r=this.adminService._storageService.getItem("user");r=JSON.parse(r),this.adminService.getAdminCartItems(r.id,r.projectID).subscribe({next:t=>{t&&t.data&&(this.cart=t.data,this.loadCartDetails())}})}loadCartDetails(){let r=0;this.cart.length>0&&this.cart.forEach(t=>{r+=+t.quantity*t.unitPrice}),this.grandTotal=parseFloat(r.toString()).toFixed(2),this.calGrandTotal=this.grandTotal}order(){if(this.cart.find(a=>a.finishCode.includes("?")))return void this.toastr.error("You cannot send order without choosing the finishes");let t=this,n=this.dataToExport.nativeElement;html2pdf().from(n).set({image:{type:"jpeg",quality:.98},html2canvas:{scale:3},jsPDF:{unit:"cm",format:"letter",orientation:"landscape"}}).toPdf().output("datauristring").then(function(a){a=a.split(",")[1];let h=new Date,ee=h.getFullYear+"-"+("00"+(h.getMonth()+1)).slice(-2)+"-"+("00"+h.getDate()).slice(-2)+" "+("00"+h.getHours()).slice(-2)+":"+("00"+h.getMinutes()).slice(-2)+":"+("00"+h.getSeconds()).slice(-2),u=new FormData;u.append("pdf",a),u.append("email","bisema@gmail.com"),u.append("cart",JSON.stringify(t.cart)),u.append("users_email",`${t.fromPerson.value.email}`),u.append("user_name",`${t.fromPerson.value.name}`),u.append("total_price",`${t.calGrandTotal}`),u.append("orderConfirmationDate",ee),t.adminService.sendEmail(u).subscribe({next:j=>{console.log(j),"error"!=j.status?t.openOrderSuccessModal():t.toastr.error("Something went wrong. Please try agin later")}})})}openOrderSuccessModal(){this.modalService.open(this.content,{centered:!0,modalDialogClass:"modal-content-custom"})}calculateDiscount(){this.calGrandTotal=this.grandTotal-this.grandTotal/100*this.discountControl.value}ngOnInit(){this.getCart()}}function O(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",21),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.showHideProjects())}),e._uU(1,"Dealer's Users"),e.qZA()}}function E(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(2);return e.KtG(i.showAddProjectDialog=!0)}),e._uU(1,"New Project"),e.qZA()}}U.\u0275fac=function(r){return new(r||U)(e.Y36(s.qu),e.Y36(d),e.Y36(k._W),e.Y36(m.FF))},U.\u0275cmp=e.Xpm({type:U,selectors:[["app-checkout"]],viewQuery:function(r,t){if(1&r&&(e.Gf(y,5),e.Gf(N,7)),2&r){let n;e.iGM(n=e.CRH())&&(t.dataToExport=n.first),e.iGM(n=e.CRH())&&(t.content=n.first)}},decls:130,vars:25,consts:[[1,"container-fluid","bg-white"],[1,"row","px-4"],["bgcolor","#f1e5f8"],[1,"row"],["dataToExport",""],[1,"col-12"],[1,"d-flex","justify-content-between","py-2"],[1,"mt-2"],[1,"border-dark"],[1,"col-md-6","col-12"],[1,"mt-4"],[3,"formGroup"],["for","from_name",1,"form-label"],["type","text","id","from_name","placeholder","Enter Name","formControlName","name",1,"form-control"],[1,"text-danger"],["fieldType","input",3,"control","labels"],["for","from_email",1,"form-label"],["type","email","id","from_email","placeholder","Enter Email","formControlName","email",1,"form-control"],["for","from_phone",1,"form-label"],["type","text","id","from_phone","placeholder","Enter Phone","formControlName","phone",1,"form-control"],["for","from_address",1,"form-label"],["id","from_address","rows","3","formControlName","address",1,"form-control"],[1,"table","table-striped"],[1,"thead-light"],[2,"white-space","nowrap"],["class","",3,"ngClass",4,"ngFor","ngForOf"],[1,"border","border-0"],["type","text",1,"form-control",3,"formControl"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn2","me-1","px-3",3,"disabled","click"],["content",""],[1,"",3,"ngClass"],[1,"modal-body"],[1,"bg-purple"],[1,"text-center","text-white","p-2"],[1,"text-center"],[1,"d-flex","justify-content-end","mt-5"],["type","button","routerLink","/admin",1,"btn","btn2","border-white",3,"click"]],template:function(r,t){1&r&&(e._UZ(0,"app-admin-header"),e.TgZ(1,"div",0)(2,"div",1)(3,"body",2)(4,"div",3,4)(6,"div",5)(7,"div",6)(8,"h4",7),e._uU(9," Invoice "),e.qZA()()(),e._UZ(10,"hr",8),e.TgZ(11,"div",9)(12,"h2",10),e._uU(13,"Buyer's Information : "),e.qZA(),e.TgZ(14,"form",11)(15,"div")(16,"label",12),e._uU(17,"Name"),e.qZA(),e._UZ(18,"input",13),e.TgZ(19,"label",14),e._UZ(20,"app-form-error-message",15),e.qZA()(),e.TgZ(21,"div")(22,"label",16),e._uU(23,"Email"),e.qZA(),e._UZ(24,"input",17),e.TgZ(25,"label",14),e._UZ(26,"app-form-error-message",15),e.qZA()(),e.TgZ(27,"div")(28,"label",18),e._uU(29,"Phone"),e.qZA(),e._UZ(30,"input",19),e.TgZ(31,"label",14),e._UZ(32,"app-form-error-message",15),e.qZA()(),e.TgZ(33,"div")(34,"label",20),e._uU(35,"Address"),e.qZA(),e._UZ(36,"textarea",21),e.TgZ(37,"label",14),e._UZ(38,"app-form-error-message",15),e.qZA()()()(),e.TgZ(39,"div",9)(40,"h2",10),e._uU(41,"Product Details"),e.qZA(),e.TgZ(42,"table",22)(43,"thead",23)(44,"tr")(45,"th"),e._uU(46,"#"),e.qZA(),e.TgZ(47,"th"),e._uU(48,"Mfg"),e.qZA(),e.TgZ(49,"th"),e._uU(50,"Cat"),e.qZA(),e.TgZ(51,"th",24),e._uU(52,"Order Code"),e.qZA(),e.TgZ(53,"th"),e._uU(54,"Description"),e.qZA(),e.TgZ(55,"th"),e._uU(56,"Rate"),e.qZA(),e.TgZ(57,"th"),e._uU(58,"Quantity"),e.qZA(),e.TgZ(59,"th"),e._uU(60,"Amount"),e.qZA()()(),e.TgZ(61,"tbody"),e.YNc(62,S,19,15,"tr",25),e.TgZ(63,"tr"),e._UZ(64,"td",26)(65,"td",26)(66,"td")(67,"td")(68,"td"),e.TgZ(69,"td"),e._uU(70,"Discount %"),e.qZA(),e._UZ(71,"td"),e.TgZ(72,"td"),e._UZ(73,"input",27),e.qZA()(),e.TgZ(74,"tr"),e._UZ(75,"td",26)(76,"td",26)(77,"td")(78,"td")(79,"td"),e.TgZ(80,"td"),e._uU(81,"Sub Total"),e.qZA(),e._UZ(82,"td"),e.TgZ(83,"td"),e._uU(84),e.ALo(85,"currency"),e.qZA()(),e.TgZ(86,"tr"),e._UZ(87,"td",26)(88,"td",26)(89,"td")(90,"td")(91,"td"),e.TgZ(92,"td"),e._uU(93,"Tax (5%)"),e.qZA(),e._UZ(94,"td"),e.TgZ(95,"td"),e._uU(96,"0"),e.qZA()(),e.TgZ(97,"tr"),e._UZ(98,"td",26)(99,"td",26)(100,"td")(101,"td")(102,"td"),e.TgZ(103,"td"),e._uU(104,"Total"),e.qZA(),e._UZ(105,"td"),e.TgZ(106,"td"),e._uU(107),e.ALo(108,"currency"),e.qZA()(),e.TgZ(109,"tr"),e._UZ(110,"td",26)(111,"td",26)(112,"td")(113,"td")(114,"td"),e.TgZ(115,"td"),e._uU(116,"Balance Due"),e.qZA(),e._UZ(117,"td"),e.TgZ(118,"td")(119,"b"),e._uU(120,"CAD"),e.qZA(),e._uU(121),e.ALo(122,"currency"),e.qZA()()()()()(),e._UZ(123,"hr",8),e.TgZ(124,"div",28)(125,"button",29),e.NdJ("click",function(){return t.order()}),e._uU(126," Order "),e.qZA()()()(),e._UZ(127,"app-admin-footer"),e.qZA(),e.YNc(128,M,9,0,"ng-template",null,30,e.W1O)),2&r&&(e.xp6(14),e.Q6J("formGroup",t.fromPerson),e.xp6(6),e.Q6J("control",t.fromPerson.get("name"))("labels",e.DdM(21,J)),e.xp6(6),e.Q6J("control",t.fromPerson.get("email"))("labels",e.DdM(22,I)),e.xp6(6),e.Q6J("control",t.fromPerson.get("phone"))("labels",e.DdM(23,D)),e.xp6(6),e.Q6J("control",t.fromPerson.get("address"))("labels",e.DdM(24,F)),e.xp6(24),e.Q6J("ngForOf",t.cart),e.xp6(11),e.Q6J("formControl",t.discountControl),e.xp6(11),e.Oqu(e.lcZ(85,15,t.grandTotal)),e.xp6(23),e.Oqu(e.lcZ(108,17,t.grandTotal)),e.xp6(14),e.hij(" ",e.lcZ(122,19,t.calGrandTotal),""),e.xp6(4),e.Q6J("disabled",!t.fromPerson.valid))},dependencies:[l.mk,l.sg,C.J,s._Y,s.Fj,s.JJ,s.JL,s.oH,s.sg,s.u,Z.rH,b,v,l.H9],styles:[".modal-body[_ngcontent-%COMP%]{background:rgba(250,204,247,.5);border:2px solid #88149d;border-radius:25px}"]});const w=function(o){return{project_table_even_row:o}};function Q(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",22)(1,"div",23),e._uU(2),e.qZA(),e.TgZ(3,"div",24)(4,"a",25),e.NdJ("click",function(){const a=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.selectProject(a.id))}),e._uU(5),e.qZA()(),e.TgZ(6,"div",24),e._uU(7),e.ALo(8,"date"),e.qZA(),e.TgZ(9,"div",23),e._uU(10),e.qZA(),e.TgZ(11,"div",24),e._uU(12),e.ALo(13,"date"),e.qZA(),e.TgZ(14,"div",26),e._uU(15),e.ALo(16,"slice"),e.qZA()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(2);e.Q6J("ngClass",e.VKq(17,w,n%2==0)),e.xp6(2),e.Oqu(i.projects.length-n),e.xp6(3),e.Oqu(t.projectName),e.xp6(2),e.Oqu(e.xi3(8,7,t.createdAt,"MM/dd/yyyy")),e.xp6(3),e.Oqu(null==t.orderConfirmationDate?"No":"Yes"),e.xp6(2),e.Oqu(null==t.orderConfirmationDate?"Not exported":e.xi3(13,10,t.orderConfirmationDate,"MM/dd/yyyy")),e.xp6(3),e.Oqu(""==t.remark?"No remarks":t.remark.length>47?e.Dn7(16,13,t.remark,0,47)+"...":t.remark)}}function Y(o,r){if(1&o&&(e.TgZ(0,"div",13)(1,"span",27),e._uU(2),e.qZA()()),2&o){const t=e.oxw(2);e.xp6(2),e.Oqu(t.projectSelectionErrorMessage)}}function G(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"div",6),e._UZ(2,"div"),e.TgZ(3,"h1",7),e._uU(4),e.qZA(),e.TgZ(5,"div"),e.YNc(6,O,2,0,"button",8),e.YNc(7,E,2,0,"button",9),e.TgZ(8,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.logout())}),e._uU(9,"Logout"),e.qZA()()(),e.TgZ(10,"div",11),e.ynx(11),e.TgZ(12,"div",12)(13,"div",13),e._UZ(14,"div",14),e.TgZ(15,"div",15)(16,"span",16),e._uU(17,"Project Name"),e.qZA()(),e.TgZ(18,"div",15)(19,"span",16),e._uU(20,"Start Date"),e.qZA()(),e.TgZ(21,"div",14)(22,"span",16),e._uU(23,"Exported"),e.qZA()(),e.TgZ(24,"div",15)(25,"span",16),e._uU(26,"Exported Date"),e.qZA()(),e.TgZ(27,"div",17)(28,"span",16),e._uU(29,"Remark"),e.qZA()()(),e.TgZ(30,"div",18),e.YNc(31,Q,17,19,"div",19),e.qZA(),e.YNc(32,Y,3,1,"div",20),e.qZA(),e.BQk(),e.qZA()()}if(2&o){const t=e.oxw();e.xp6(4),e.hij("",t.loggedInUser.DealerName," Projects"),e.xp6(2),e.Q6J("ngIf",!t.loggedInUser.dealers_id),e.xp6(1),e.Q6J("ngIf",!t.loggedInUser.dealers_id),e.xp6(24),e.Q6J("ngForOf",t.projects),e.xp6(1),e.Q6J("ngIf",""!=t.projectSelectionErrorMessage)}}function H(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",22),e._UZ(1,"div",15),e.TgZ(2,"div",24),e._uU(3),e.qZA(),e.TgZ(4,"div",24),e._uU(5),e.qZA(),e.TgZ(6,"div",24)(7,"input",28),e.NdJ("click",function(){const a=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.updateUser(a))}),e.qZA()(),e.TgZ(8,"div",24)(9,"a",29),e.NdJ("click",function(){const a=e.CHM(t).$implicit,p=e.oxw(2);return e.KtG(p.deleteUser(a.email))}),e._UZ(10,"fa-icon",30),e.qZA()()()}if(2&o){const t=r.$implicit,n=r.index,i=e.oxw(2);e.Q6J("ngClass",e.VKq(5,w,n%2==0)),e.xp6(3),e.Oqu(n+1),e.xp6(2),e.Oqu(t.email),e.xp6(2),e.s9C("checked","true"==t.is_freeze?"true":""),e.xp6(3),e.Q6J("icon",i.faTrash)}}function $(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",5)(1,"div",6),e._UZ(2,"div"),e.TgZ(3,"h1",7),e._uU(4),e.qZA(),e.TgZ(5,"div")(6,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.showHideProjects())}),e._uU(7,"Projects"),e.qZA(),e.TgZ(8,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw(),a=e.MAs(6);return e.KtG(i.openUserModal(a))}),e._uU(9,"New User"),e.qZA(),e.TgZ(10,"button",10),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.logout())}),e._uU(11,"Logout"),e.qZA()()(),e.TgZ(12,"div",11)(13,"div",12)(14,"div",13),e._UZ(15,"div",15),e.TgZ(16,"div",15)(17,"span",16),e._uU(18,"List"),e.qZA()(),e.TgZ(19,"div",15)(20,"span",16),e._uU(21,"Email"),e.qZA()(),e.TgZ(22,"div",15)(23,"span",16),e._uU(24,"Freeze"),e.qZA()(),e.TgZ(25,"div",15)(26,"span",16),e._uU(27,"Actions"),e.qZA()()(),e.TgZ(28,"div",18),e.YNc(29,H,11,7,"div",19),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.hij("",t.loggedInUser.DealerName," Users"),e.xp6(25),e.Q6J("ngForOf",t.users)}}function K(o,r){1&o&&e._UZ(0,"div",31)}function L(o,r){if(1&o&&(e.TgZ(0,"div",44),e._uU(1),e.qZA()),2&o){const t=e.oxw(2);e.xp6(1),e.hij(" ",t.projectErrorMessage," ")}}function B(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",32)(1,"div",33)(2,"h1",34),e._uU(3,"Add new project"),e.qZA(),e.TgZ(4,"form",35),e.NdJ("submit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.projectSelected())}),e.TgZ(5,"div",36)(6,"span",37),e._uU(7,"Project name:"),e.qZA(),e._UZ(8,"input",38),e.qZA(),e.TgZ(9,"div",36)(10,"span",37),e._uU(11,"Project remark:"),e.qZA(),e._UZ(12,"textarea",39),e.qZA(),e.YNc(13,L,2,1,"div",40),e.TgZ(14,"div",41)(15,"button",42),e._uU(16,"Save"),e.qZA(),e.TgZ(17,"button",43),e.NdJ("click",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.cancelAddProject())}),e._uU(18,"Cancel"),e.qZA()()()()()}if(2&o){const t=e.oxw();e.xp6(4),e.Q6J("formGroup",t.projectForm),e.xp6(9),e.Q6J("ngIf",""!=t.projectErrorMessage)}}const z=function(){return{label1:"Email"}},R=function(){return{label1:"Password"}};function W(o,r){if(1&o){const t=e.EpF();e.TgZ(0,"div",45)(1,"h4",46),e._uU(2,"Create User"),e.qZA(),e.TgZ(3,"button",47),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.dismiss("Cross click"))}),e._uU(4,"X"),e.qZA()(),e.TgZ(5,"div",48)(6,"form",35),e.NdJ("submit",function(){e.CHM(t);const i=e.oxw();return e.KtG(i.createUser())}),e.TgZ(7,"div",49)(8,"div",50),e._UZ(9,"input",51),e.TgZ(10,"div",52)(11,"span",53),e._UZ(12,"fa-icon",30),e.qZA()()(),e.TgZ(13,"label",54),e._UZ(14,"app-form-error-message",55),e.qZA()(),e.TgZ(15,"div",49)(16,"div",50),e._UZ(17,"input",56),e.TgZ(18,"div",52)(19,"span",53),e._UZ(20,"fa-icon",30),e.qZA()()(),e.TgZ(21,"label",54),e._UZ(22,"app-form-error-message",55),e.qZA()(),e.TgZ(23,"div",57)(24,"button",58),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.close("Close click"))}),e._uU(25,"Close"),e.qZA(),e.TgZ(26,"button",59),e.NdJ("click",function(){const a=e.CHM(t).$implicit;return e.KtG(a.close("Close click"))}),e._UZ(27,"fa-icon",30),e._uU(28," Create "),e.qZA()()()()}if(2&o){const t=e.oxw();e.xp6(6),e.Q6J("formGroup",t.userForm),e.xp6(6),e.Q6J("icon",t.faEnvelope),e.xp6(2),e.Q6J("control",t.userForm.get("email"))("labels",e.DdM(9,z)),e.xp6(6),e.Q6J("icon",t.faKey),e.xp6(2),e.Q6J("control",t.userForm.get("password"))("labels",e.DdM(10,R)),e.xp6(4),e.Q6J("disabled",!t.userForm.valid),e.xp6(1),e.Q6J("icon",t.faArrowRight)}}class x{constructor(r,t,n,i){this.adminService=r,this.fb=t,this.router=n,this.modalService=i,this.faEnvelope=_.FU$,this.faKey=_.DD4,this.faArrowRight=_.eFW,this.faPencil=_.TzT,this.faTrash=_.$aW,this.loggedInUser="",this.dealers_id=0,this.projects=[],this.showAddProjectDialog=!1,this.projectSelectionErrorMessage="",this.projectErrorMessage="",this.users=[],this.showProjects=!1,this.userForm=this.fb.group({email:["",[s.kI.required,s.kI.email]],password:["",[s.kI.required]]}),this.projectForm=this.fb.group({projectRemark:["",[s.kI.required]],projectName:["",[s.kI.required]]})}loadAllProjects(r=null){this.loggedInUser=r,this.dealers_id=this.loggedInUser.dealers_id,this.dealers_id||(this.dealers_id=this.loggedInUser.id),this.adminService.getProjectsByDealerID(this.dealers_id).subscribe({next:t=>{this.projects=t.sort((n,i)=>i.id-n.id),this.showProjects=!0},error:t=>{console.log(`Failed to get projects by dealer id. Error details: ${JSON.stringify(t)}`)}})}showHideProjects(){this.showProjects=!this.showProjects}selectProject(r){const t=this.projects.filter(n=>n.id===r);t&&t.length>0?t[0].isClosed?this.projectSelectionErrorMessage="Please select project which is not exported. You cannot proceed with exported project.":this.updateUserDetailsAndLogin(t[0].id,t[0].projectName,t[0].BCProjectNumber):this.projectSelectionErrorMessage="Something went wrong ! Project not found. please try again and if issue persist contact administrator."}updateUserDetailsAndLogin(r,t,n=!1){this.loggedInUser.projectID=parseInt(r),this.loggedInUser.projectName=t,localStorage.setItem("user",JSON.stringify(this.loggedInUser)),this.projectForm.reset(),this.showAddProjectDialog=!1,n&&this.adminService.getProjectsByDealerID(this.dealers_id).subscribe({next:i=>{this.projects=i.sort((a,p)=>p.id-a.id)},error:i=>{console.log(`Failed to get projects by dealer id. Error details: ${JSON.stringify(i)}`)}}),void 0===this.loggedInUser.dealers_id?n||this.router.navigateByUrl("/cart"):this.router.navigateByUrl("/specification")}projectSelected(){this.projectErrorMessage="",""===this.projectForm.value.projectName?this.projectErrorMessage="Please enter project name.":""===this.projectForm.value.projectRemark?this.projectErrorMessage="Please enter project remark.":this.dealers_id>0?this.adminService.checkIfExistsWithName(this.dealers_id,this.projectForm.value.projectName).subscribe({next:r=>{0==r.data?this.adminService.createProject({dealers_id:this.dealers_id,projectName:this.projectForm.value.projectName,remark:this.projectForm.value.projectRemark}).subscribe({next:t=>{t.data>0?this.updateUserDetailsAndLogin(t.data,this.projectForm.value.projectName,!0):this.projectErrorMessage=t.message},error:t=>{console.log(`Error occured while creating project. Error details: ${JSON.stringify(t)}`)}}):this.projectErrorMessage=r.message},error:r=>{console.log(`Error occured while checking if project exists same name or not. Error details: ${JSON.stringify(r)}`)}}):this.projectErrorMessage="Something went wrong ! Dealer not found. Please try again and if issue persist contact administrator."}cancelAddProject(){this.showAddProjectDialog=!1}getUsers(r){this.adminService.getUsers(r).subscribe({next:t=>{this.users=t.data},error:t=>{console.log(t)}})}deleteUser(r){this.adminService.deleteUser(r).subscribe({next:t=>{this.getUsers(this.loggedInUser.id)},error:t=>{}})}openUserModal(r){this.modalService.open(r,{centered:!0})}updateUser(r){r.is_freeze="true"==r.is_freeze?"false":"true",this.adminService.updateUser(r).subscribe({next:t=>{"error"!=t.status&&this.getUsers(this.loggedInUser.id)},error:t=>{console.log(t)}})}createUser(){let r=this.userForm.value;r.dealers_id=this.loggedInUser.id,this.adminService.addUser(r).subscribe({next:t=>{"error"!=t.status&&(this.getUsers(this.loggedInUser.id),this.userForm.reset())},error:t=>{console.log(t)}})}logout(){this.adminService._storageService.removeItem("user"),this.router.navigateByUrl("/login")}ngOnInit(){let r=JSON.parse(this.adminService._storageService.getItem("user"));this.loadAllProjects(r),this.getUsers(r.id)}}x.\u0275fac=function(r){return new(r||x)(e.Y36(d),e.Y36(s.qu),e.Y36(Z.F0),e.Y36(m.FF))},x.\u0275cmp=e.Xpm({type:x,selectors:[["app-users"]],decls:7,vars:4,consts:[[1,"d-flex","h-100","align-items-center","justify-content-center"],["class","card w-75 mx-auto",4,"ngIf"],["class","dialog_overlay",4,"ngIf"],["class","card dialog",4,"ngIf"],["content",""],[1,"card","w-75","mx-auto"],[1,"card-header","d-flex","justify-content-between","align-items-center","bg-purple"],[1,"text-center","text-white","mb-0"],["class","btn btn-light btn2 new_project_button me-2",3,"click",4,"ngIf"],["class","btn btn-light btn2 new_project_button",3,"click",4,"ngIf"],[1,"btn","btn-light","btn2","new_project_button",3,"click"],[1,"card-body"],[1,"pb-0","pt-0","pr-0","pl-0","project_table_header_border"],[1,"row","ml-0","mr-0","bg-purple"],[1,"col-1"],[1,"col-2"],[1,"text-white","project_table_header"],[1,"col-4"],[1,"project_table_body"],["class","row ml-0 mr-0",3,"ngClass",4,"ngFor","ngForOf"],["class","row ml-0 mr-0 bg-purple",4,"ngIf"],[1,"btn","btn-light","btn2","new_project_button","me-2",3,"click"],[1,"row","ml-0","mr-0",3,"ngClass"],[1,"col-1","pt-2","pb-2"],[1,"col-2","pt-2","pb-2"],["href","javascript:void;",3,"click"],[1,"col-4","pt-2","pb-2"],[1,"pt-2","pb-2","text-center","text-white","project_error_message"],["type","checkbox","name","","id","",3,"checked","click"],["href","javascript:;",1,"text-danger",3,"click"],[3,"icon"],[1,"dialog_overlay"],[1,"card","dialog"],[1,"card-body","bg-purple"],[1,"text-center","text-white","mb-3"],[3,"formGroup","submit"],[1,"input-group","mb-3"],[1,"text-white","mt-2","mr-3",2,"width","20%"],["type","text","formControlName","projectName",1,"form-control"],["formControlName","projectRemark",1,"form-control"],["class","input-group mb-3 text-white text-center","style","display: block",4,"ngIf"],[1,"mb-3","text-center"],["type","submit",1,"btn","btn2","mr-3","border-white"],[1,"btn","btn2","border-white",3,"click"],[1,"input-group","mb-3","text-white","text-center",2,"display","block"],[1,"modal-header","bg-purple"],[1,"modal-title","text-white"],["type","button","aria-label","Close",1,"text-white","btn","btn-link",3,"click"],[1,"modal-body","bg-purple"],[1,"form-group","mb-1"],[1,"input-group"],["type","text","placeholder","Your Email","formControlName","email",1,"form-control"],[1,"input-group-append"],[1,"input-group-text"],[1,"text-white"],["fieldType","input",3,"control","labels"],["type","password","placeholder","Your Password","formControlName","password",1,"form-control"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn2","ms-2","border-white",3,"click"],["type","submit",1,"btn","btn2","border-white",3,"disabled","click"]],template:function(r,t){1&r&&(e.TgZ(0,"div",0),e.YNc(1,G,33,5,"div",1),e.YNc(2,$,30,2,"div",1),e.qZA(),e.YNc(3,K,1,0,"div",2),e.YNc(4,B,19,2,"div",3),e.YNc(5,W,29,11,"ng-template",null,4,e.W1O)),2&r&&(e.xp6(1),e.Q6J("ngIf",t.loggedInUser&&t.showProjects),e.xp6(1),e.Q6J("ngIf",t.loggedInUser&&!t.showProjects),e.xp6(1),e.Q6J("ngIf",t.showAddProjectDialog),e.xp6(1),e.Q6J("ngIf",t.showAddProjectDialog))},dependencies:[l.mk,l.sg,l.O5,C.J,s._Y,s.Fj,s.JJ,s.JL,s.sg,s.u,A.BN,l.OU,l.uU],styles:[".card[_ngcontent-%COMP%]{width:35%}.project_table_header[_ngcontent-%COMP%]{font-size:14px!important;font-weight:700;position:relative;float:left;margin:8px 0}.project_table_header_border[_ngcontent-%COMP%]{border-top:1px solid #fff}.project_table_body[_ngcontent-%COMP%]{max-height:288px;overflow-y:auto}.project_error_message[_ngcontent-%COMP%]{width:100%}.new_project_button[_ngcontent-%COMP%]{margin:10px 10px 0 0}.project_table_even_row[_ngcontent-%COMP%]{background-color:#eedfff}.dialog[_ngcontent-%COMP%]{top:50%;left:50%;width:50em;margin-top:-9em;margin-left:-25em;position:fixed;border:none!important;z-index:9999}.dialog_overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;opacity:.4;z-index:999}"]});const X=[{path:"checkout",component:U},{path:"",component:x}];class g{}g.\u0275fac=function(r){return new(r||g)},g.\u0275mod=e.oAB({type:g}),g.\u0275inj=e.cJS({imports:[Z.Bz.forChild(X),Z.Bz]});var V=c(7929);class f{}f.\u0275fac=function(r){return new(r||f)},f.\u0275mod=e.oAB({type:f}),f.\u0275inj=e.cJS({providers:[d],imports:[l.ez,V.m,g]})}}]);